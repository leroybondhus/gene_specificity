---
title: "Yenifer_Workspace"
output: html_document
---

```{r}
GTEX.data <-read.csv("/Users/yeniferhernandez/Desktop/Arboleda_Lab/gtex_medians_PC_only_wo_MT.csv", header = TRUE, sep=",")  
num_cols <- unlist(lapply(GTEX.data , is.numeric))
GTEX.data_num <- GTEX.data[ , num_cols]  
GTEX.data_num <- GTEX.data_num[,-1]
mean_exp <- apply(GTEX.data_num , 1, mean) 
median_exp <- apply(GTEX.data_num , 1, median)
sd_exp <- apply(GTEX.data_num , 1, sd)
GTEX_log <- log(GTEX.data_num + 1)# log of GTEX gene expression 
mean_log <- apply(GTEX_log , 1, mean) 
sd_log <- apply(GTEX_log , 1, sd) 
sd_log<- abs(sd_log)
median_log <- apply(GTEX_log , 1, median)
gene_sd <- cbind.data.frame(GTEX.data[,2],sd_log) 
colnames(gene_sd) <- c("Description","Standard Deviation Log") 
Name <- GTEX.data[,1]

#cosine similarity matrix 
cosine_similarity_matrix <- function(data_set,col_num) {
cosine_simi<- matrix(0, nrow = col_num, ncol = col_num)
for(y in 1:col_num) {
  for(x in 1:col_num) {
product_xy <- data_set[,x] * data_set[,y]
sum_xy <- sum(product_xy)
magnitude_x <- data_set[,x]^2
magnitude_x<- sum(magnitude_x)
magn_x <- sqrt(magnitude_x)
magnitude_y <- data_set[,y]^2
magnitude_y <- sum(magnitude_y)
magn_y <- sqrt(magnitude_y)
magn_z <- magn_x * magn_y
cos_sin <-  sum_xy/magn_z
colnames(cosine_simi)<-colnames(data_set)
rownames(cosine_simi)<-colnames(GTEX.data_num)
cosine_simi[x,y] <- cos_sin


  }
}
View(cosine_simi)

}
#actual standard deviations matrix
actual_sdev_matrix<- function(data,mean,sd,row_num,col_num) {
actu_sdev <- matrix(0, nrow = row_num, ncol = col_num)
for(j in 1:col_num) {
  for(i in 1:row_num)  {
   actu_sdev[i,j] <- (data[i,j] - mean[i])/sd[i]
}      
}
actu_sdev <-replace(actu_sdev, is.na(actu_sdev), 0)
n <- matrix(0, nrow = col_num, ncol = col_num)
dot_product_matrix <- matrix(0, nrow = col_num, ncol = col_num)
for(G1 in 1:col_num) {
  for(G2 in 1:col_num)  {
   n <- actu_sdev[,G1]*actu_sdev[,G2]
   dot_product_matrix [G2,G1]<- sum(n)
}
}
diag_val <- diag(dot_product_matrix )
diag_matrix <- data.matrix(diag_val)
simi_matrix<- matrix(0, nrow = col_num, ncol = col_num)
for(G1 in 1:col_num) {
  for(G2 in 1:col_num)  {
 simi_matrix[G1,G2]<-  dot_product_matrix [G1,G2]/(max(diag_matrix [G1],diag_matrix [G2]))
}
}
colnames(simi_matrix)<-colnames(data)
rownames(simi_matrix)<-colnames(data)
View(simi_matrix)


}
#Pearson's coefficients function matrix 
pearson_coefficient_matrix <- function(data_set,col_num) {
  pearson_matrix<- matrix(0, nrow = col_num, ncol = col_num)
  for(y in 1:col_num) {
     for(x in 1:col_num)  {
  mean_x <- mean(data_set[,x])
  mean_y <- mean(data_set[,y])
  minus_x <- (data_set[,x] - mean_x)
  minus_y <- (data_set[,y] - mean_y)
  product_xy <- minus_x*minus_y
  sum_xy<- sum(product_xy)
  power_x <- minus_x ^ 2 
  sum_power_x <-sum(power_x)
  square_x <- sqrt(sum_power_x)
  power_y <- minus_y ^ 2
  sum_power_y <-sum(power_y)
  square_y <- sqrt(sum_power_y)
  product_square <- square_x*square_y
  PE <- sum_xy/product_square
  colnames(pearson_matrix)<-colnames(data_set)
  rownames(pearson_matrix)<-colnames(data_set)
  pearson_matrix[x,y] <- PE
}
}
View(pearson_matrix)
}


#cosine dissimilarity 
cosine_dissimilarity <- function(data_set,x,y) {
cos_sin <- 1 - cosine_similarity(data_set,x,y)
return(cos_sin)
}
```
#####DISTANCE TREES
```{r}
#function cluster dendogram 
cluster_dendogram <- function(data_simi){
 cluster<-as.data.frame(as.table(data_simi))
dist_mat <- data_simi
dist_mat <- dist(t(data_simi), diag = F, upper = F)
dist_mat_norm <- dist_mat / max(dist_mat)  
hclus <- hclust(dist_mat_norm)
as.dendrogram(hclus)
plot(hclus) 
}


#example cosine similarity 
cosine_similarity_matrix(GTEX.data_num,54)
cluster_dendogram(cosine_simi)





#example pearson_coefficient 
pearson_coefficient_matrix(GTEX.data_num,54)
cluster_dendogram(pearson_matrix)

  

#standard deviations 
#example of actual standard deviations
actual_sdev_matrix(GTEX_log,mean_log,sd_log,19193,54)
cluster_dendogram(simi_matrix)


```
